import{d as a,cm as e,r as t,cn as s,a3 as l,m as o,h as n,N as u,E as i,F as g,a as d,o as c,c as p,i as m,f as r,w as h,y as v,A as f,H as w,v as L}from"./vendor.a2f65e0a.js";import{a as y}from"./api.c7737167.js";import{f as k}from"./time.5cdf33f2.js";import{_ as C}from"./ConfirmModel.vue_vue&type=script&setup=true&lang.21a1a799.js";var D=a({name:"AlarmLogs",components:{ConfirmModel:C},setup(){const a=e("reload"),i=t(1),g=[{type:"selection"},{title:"logID",key:"logID"},{title:"告警内容",key:"alarmName"},{title:"告警等级",key:"alarmLevel"},{title:"创建时间",key:"createTime"},{title:"处理状态",key:"statusValue"},{title:"操作",key:"action",render:(a,e)=>n(u,{onClick:()=>c(a)},{default:()=>1==i.value?"处理":2==i.value?"关闭":3==i.value?"删除":void 0})}],d=t(!1),c=a=>{console.log(i.value,a);let e=[];e.push(a.logID),3==i.value?(d.value=!0,v.value=e):o.put(y.alarmLogsListPut,{statusID:i.value+1,alarmLogIDList:e}).then((a=>{console.log(a),100==a.data.status&&(window.$message.success(a.data.message),C(k.value,f.value,i.value,h.value))}))},p=a=>{o.delete(y.alarmLogsListPut,{data:{alarmLogIDList:a}}).then((a=>{console.log("del====",a),100==a.data.status&&(window.$message.success(a.data.message),C(k.value,f.value,i.value,h.value))}))},m=t([]),r=s(),h=t();"all"==r.params.alarmID?h.value="":h.value=r.params.alarmID,console.log(h.value);const v=t([]),f=t(20),w=t(),L=t(),k=t(1),C=(a,e,t,s)=>{o.get(y.alarmLogsList,{params:{pageNum:a,pageSize:e,statusID:t,alarmID:s}}).then((a=>{console.log(a),100==a.data.status&&(m.value=a.data.data.list,w.value=a.data.data.pages,L.value=a.data.data.totalRows,k.value=a.data.data.page)}))};return l((()=>{C(k.value,f.value,i.value,h.value)})),{refresh:a,deleteLogs:p,handleModelStatus:a=>{console.log(1),d.value=a.modelStatus,a.result?p(v.value):window.$message.info("取消删除")},modelStatus:d,tableData:m,alarmID:h,columns:g,checkedRowKeys:v,pageCounts:w,page:k,pageSize:f,totalRows:L,getLogsList:C,formattedValue:t(null),format:"YYYY-mm-dd HH:MM:SS",rowKey:a=>a.logID,handleCheck(a){v.value=a},pageName:i,logsOptValue:t(null),logsOptOptions:[{label:"待处理",value:1},{label:"处理中",value:2},{label:"关闭",value:3},{label:"删除",value:4}]}},methods:{handleLogsBtnClick(a){this.pageName=a,this.getLogsList(1,this.pageSize,this.pageName,this.alarmID)},changeTime(a){console.log(a),console.log(k(this.format,a))},handlePageChange(a){console.log(a),this.getLogsList(a,this.pageSize,this.pageName,this.alarmID)},handleSelection(){this.checkedRowKeys.length<=0?window.$message.warning("请选择要操作的数据"):null==this.logsOptValue?window.$message.warning("请选择要执行的操作"):4==this.logsOptValue?this.modelStatus=!0:o.put(y.alarmLogsListPut,{statusID:parseInt(this.logsOptValue),alarmLogIDList:this.checkedRowKeys}).then((a=>{100==a.data.status&&(window.$message.success(a.data.message),this.getLogsList(this.page,this.pageSize,this.pageName,this.alarmID),this.refresh())})),console.log("=======",this.logsOptValue,this.checkedRowKeys)}}});i("data-v-0679fdac");const I={class:"logs-page"},S=m("h1",{style:{"margin-top":"0","margin-bottom":"30px"}},"智慧油田设备告警记录",-1),b={class:"logs-search"},O=L(" 待处理 "),M=L(" 处理中 "),V=L(" 关闭 "),K={style:{display:"flex"}},N=m("span",{style:{"font-size":"15px","line-height":"2"}}," 批量操作 ",-1),R={style:{width:"200px","margin-left":"20px"}},_=L(" 执行 ");g(),D.render=function(a,e,t,s,l,o){const n=d("n-button"),u=d("n-select"),i=d("n-data-table"),g=d("n-pagination"),L=d("ConfirmModel");return c(),p(w,null,[m("div",I,[S,m("div",b,[m("div",null,[r(n,{class:"log-btn",type:"warning",dashed:"",onClick:e[0]||(e[0]=e=>a.handleLogsBtnClick(1))},{default:h((()=>[O])),_:1}),r(n,{class:"log-btn",type:"success",dashed:"",onClick:e[1]||(e[1]=e=>a.handleLogsBtnClick(2))},{default:h((()=>[M])),_:1}),r(n,{class:"log-btn",type:"info",dashed:"",onClick:e[2]||(e[2]=e=>a.handleLogsBtnClick(3))},{default:h((()=>[V])),_:1})]),m("div",K,[N,m("div",R,[r(u,{value:a.logsOptValue,"onUpdate:value":e[3]||(e[3]=e=>a.logsOptValue=e),options:a.logsOptOptions},null,8,["value","options"])]),r(n,{class:"log-btn",type:"info",onClick:a.handleSelection},{default:h((()=>[_])),_:1},8,["onClick"])])]),r(i,{columns:a.columns,data:a.tableData,"row-key":a.rowKey,"onUpdate:checkedRowKeys":a.handleCheck},null,8,["columns","data","row-key","onUpdate:checkedRowKeys"]),v(r(g,{page:a.page,"onUpdate:page":[e[4]||(e[4]=e=>a.page=e),a.handlePageChange],"page-count":a.pageCounts},null,8,["page","page-count","onUpdate:page"]),[[f,a.pageCounts>1]])]),r(L,{modelStatus:a.modelStatus,content:"是否删除已选择的数据?",onHandleModelStatus:a.handleModelStatus},null,8,["modelStatus","onHandleModelStatus"])],64)},D.__scopeId="data-v-0679fdac";export{D as default};
