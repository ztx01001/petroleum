import{d as e,a3 as a,a4 as t,r as s,m as o,eW as i,E as n,F as l,a as d,o as r,c as m,f as c,w as p,i as u,v as g}from"./vendor.a2f65e0a.js";import{f as h}from"./time.5cdf33f2.js";import{a as v}from"./api.c7737167.js";import{u as f}from"./userEchar.9f48f366.js";import{s as y}from"./websockt.7ac8212a.js";import{M as w,a as x}from"./MdArrowRoundForward.82719fc9.js";import"./install.50cc89d0.js";var D=e({components:{MdArrowRoundBack:w,MdArrowRoundForward:x},name:"ForecastData",setup(){a((()=>{y.init(c)})),t((()=>{y.close()}));const e=s(),i=s(1),n=s([]),l=s(null),d=s(null),r=s([]),m={title:{text:"SARIMAX模型预测数据与真实数据对比"},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{},toolbox:{feature:{}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:[]}],yAxis:[{position:"left",type:"value",min:function(e){return Math.abs(e.min)},max:function(e){return Math.abs(e.max)}}],series:[{name:"实时数据",type:"line",smooth:!0,label:{show:!0,position:"top"},emphasis:{focus:"series"},data:[]},{name:"预测数据",type:"line",smooth:!0,label:{show:!0,position:"top"},emphasis:{focus:"series"},data:[]}]},c=a=>{console.log(a);let t=JSON.parse(a.data);"data"==t.messageType&&(d.value?(m.xAxis[0].data.push(t.time),t.data.forEach((a=>{a.id===d.value&&(console.log(a.id,d.value,a.value),m.series[0].data.push(a.value),o.get(v.sarimaxValue,{params:{value:a.value}}).then((a=>{console.log("========",a),200===a.data.status?(m.series[1].data.push(a.data.data),console.log(a.data.data,m),e.value=f(m,"sarimax-analysis01")):window.$message.error(a.data.detail)})))}))):window.$message.error("请选择设备"))};return{myChart01:e,option01:m,DevicesTypeOptions:n,DevicesOptions:r,datetimerange:s(null),format:"YYYY-mm-dd HH:MM:SS",startTime:s(null),endTime:s(null),currentStatus:s("process"),currentRef:i,deviceType:l,deviceID:d,image1:s(""),show:s(!1)}},mounted(){o.get(v.deviceType).then((e=>{console.log(e.data),100==e.data.status?this.DevicesTypeOptions=e.data.data:window.$message.error(e.data.message)})).catch((e=>{console.log(e)}))},methods:{selectDeviceTypeGet(e){console.log(e),this.deviceID=null,this.option01.xAxis[0].data=[],this.option01.series[0].data=[],this.option01.series[1].data=[],i(document.getElementById("sarimax-analysis01")).dispose(),o.get(v.deviceType+"/"+e).then((e=>{console.log(e),100==e.data.status?this.DevicesOptions=e.data.data:window.$message.error(e.data.message)})).catch((e=>{console.log(e)}))},onChangeData(e){console.log(e),this.startTime=h(this.format,e[0]),this.endTime=h(this.format,e[1]),console.log(this.startTime,this.endTime)},getPyodData(){console.log(this.deviceID),this.deviceID?this.startTime||this.endTime?o.get(v.exportSarima,{params:{sensorID:this.deviceID,start:this.startTime,end:this.endTime}}).then((e=>{console.log(e.data.message),100===e.data.status?window.$message.success(e.data.message):window.$message.error(e.data.message)})):window.$message.warning("请选择导出时间"):window.$message.warning("请选择一个设备")},getHistoryDataImage(){o.get(v.sarimaxModel).then((e=>{console.log(e),200===e.data.status&&(this.image1=e.data.data,this.show=!1,console.log(this.image1))}))},exportData(e){switch(e){case 1:this.getPyodData();break;case 2:this.show=!0,this.getHistoryDataImage()}}}});n("data-v-2fb4f72a");const T={class:"warning-page"},b=u("h1",{style:{"margin-top":"0","margin-bottom":"30px"}},"智慧油田设备SARIMAX数据预测",-1),I=u("div",{class:"model-title"},"选择训练模型数据",-1),A={class:"device-type"},M={style:{"min-width":"500px"}},_={style:{"min-width":"300px"}},$={style:{"min-width":"300px"}},j=g(" 导出数据 "),k=g(" 查看历史数据预测 "),O={class:"page-main"},S=u("div",{class:"page-main"},[u("div",{id:"sarimax-analysis01",class:"alarm-panel01 item"})],-1);l(),D.render=function(e,a,t,s,o,i){const n=d("n-date-picker"),l=d("n-select"),g=d("n-button"),h=d("n-grid-item"),v=d("n-grid"),f=d("n-image"),y=d("n-spin");return r(),m("div",T,[b,I,c(v,{"x-gap":24,cols:24},{default:p((()=>[c(h,null,{default:p((()=>[u("div",A,[u("div",M,[c(n,{value:e.datetimerange,"onUpdate:value":[a[0]||(a[0]=a=>e.datetimerange=a),e.onChangeData],type:"datetimerange"},null,8,["value","onUpdate:value"])]),u("div",_,[c(l,{class:"model-input",value:e.deviceType,"onUpdate:value":[a[1]||(a[1]=a=>e.deviceType=a),e.selectDeviceTypeGet],placeholder:"请选择设备类型",options:e.DevicesTypeOptions},null,8,["value","options","onUpdate:value"])]),u("div",$,[c(l,{class:"model-input",value:e.deviceID,"onUpdate:value":a[2]||(a[2]=a=>e.deviceID=a),placeholder:"请选择设备",options:e.DevicesOptions},null,8,["value","options"])]),c(g,{type:"info",onClick:a[3]||(a[3]=a=>e.exportData(1))},{default:p((()=>[j])),_:1})])])),_:1})])),_:1}),c(v,{"x-gap":24,cols:24,style:{"margin-top":"3rem"}},{default:p((()=>[c(h,null,{default:p((()=>[c(y,{show:e.show},{default:p((()=>[c(g,{quaternary:"",type:"primary",onClick:a[4]||(a[4]=a=>e.exportData(2))},{default:p((()=>[k])),_:1}),u("div",O,[c(f,{src:e.image1},null,8,["src"])])])),_:1},8,["show"])])),_:1})])),_:1}),c(v,{"x-gap":24,cols:24},{default:p((()=>[c(h,null,{default:p((()=>[S])),_:1})])),_:1})])},D.__scopeId="data-v-2fb4f72a";export{D as default};
