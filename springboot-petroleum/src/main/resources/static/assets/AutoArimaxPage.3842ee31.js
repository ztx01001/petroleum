import{d as e,a2 as a,a3 as t,a4 as s,r as o,m as i,eW as n,E as l,F as d,a as r,o as c,c as m,f as p,w as u,i as g,v as h}from"./vendor.a2f65e0a.js";import{f as v}from"./time.5cdf33f2.js";import{a as y}from"./api.c7737167.js";import{u as f}from"./userEchar.9f48f366.js";import{s as w}from"./websockt.7ac8212a.js";import{M as x,a as D}from"./MdArrowRoundForward.82719fc9.js";import"./install.50cc89d0.js";var T=e({components:{MdArrowRoundBack:x,MdArrowRoundForward:D},name:"ForecastData",setup(){a((()=>{})),t((()=>{w.init(p)})),s((()=>{w.close()}));const e=o(),n=o(1),l=o([]),d=o(null),r=o(null),c=o([]),m={title:{text:"AUTO_ARIMA模型预测数据与真实数据对比"},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{},toolbox:{feature:{}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:[]}],yAxis:[{position:"left",type:"value",min:function(e){return Math.abs(e.min)},max:function(e){return Math.abs(e.max)}}],series:[{name:"实时数据",type:"line",smooth:!0,label:{show:!0,position:"top"},emphasis:{focus:"series"},data:[]},{name:"预测数据",type:"line",smooth:!0,label:{show:!0,position:"top"},emphasis:{focus:"series"},data:[]}]},p=a=>{console.log(a);let t=JSON.parse(a.data);"data"==t.messageType&&(r.value?(m.xAxis[0].data.push(t.time),t.data.forEach((a=>{a.id===r.value&&(console.log(a.id,r.value,a.value),m.series[0].data.push(a.value),i.get(y.auto_arimaxValue,{params:{value:a.value}}).then((a=>{console.log("========",a),200===a.data.status?(m.series[1].data.push(a.data.data),console.log(a.data.data,m),e.value=f(m,"auto-analysis01")):window.$message.error(a.data.detail)})))}))):window.$message.error("请选择设备"))};return{myChart01:e,DevicesTypeOptions:l,DevicesOptions:c,datetimerange:o(null),format:"YYYY-mm-dd HH:MM:SS",startTime:o(null),endTime:o(null),currentStatus:o("process"),currentRef:n,deviceType:d,deviceID:r,auto_image:o(""),show:o(!1),option01:m}},mounted(){i.get(y.deviceType).then((e=>{console.log(e.data),100==e.data.status?this.DevicesTypeOptions=e.data.data:window.$message.error(e.data.message)})).catch((e=>{console.log(e)}))},methods:{selectDeviceTypeGet(e){console.log(e),this.deviceID=null,this.option01.xAxis[0].data=[],this.option01.series[0].data=[],this.option01.series[1].data=[],n(document.getElementById("auto-analysis01")).dispose(),i.get(y.deviceType+"/"+e).then((e=>{console.log(e),100==e.data.status?this.DevicesOptions=e.data.data:window.$message.error(e.data.message)})).catch((e=>{console.log(e)}))},onChangeData(e){console.log(e),this.startTime=v(this.format,e[0]),this.endTime=v(this.format,e[1])},getPyodData(){console.log(this.deviceID),this.deviceID?this.startTime||this.endTime?i.get(y.exportAutoarima,{params:{sensorID:this.deviceID,start:this.startTime,end:this.endTime}}).then((e=>{console.log(e.data.message),100===e.data.status?window.$message.success(e.data.message):window.$message.error(e.data.message)})):window.$message.warning("请选择导出时间"):window.$message.warning("请选择一个设备")},getHistoryDataImage(){i.get(y.auto_arimaxModel).then((e=>{console.log(e),200===e.data.status&&(console.log(e.data),this.auto_image=e.data.data,this.show=!1,console.log(this.auto_image))}))},exportData(e){switch(e){case 1:this.getPyodData();break;case 2:this.show=!0,this.getHistoryDataImage()}}}});l("data-v-09b3e9ea");const _={class:"warning-page"},b=g("h1",{style:{"margin-top":"0","margin-bottom":"30px"}},"智慧油田AUTO_ARIMA模型数据预测",-1),A=g("div",{class:"model-title"},"选择训练模型数据",-1),I={class:"device-type"},M={style:{"min-width":"500px"}},O={style:{"min-width":"300px"}},$={style:{"min-width":"300px"}},j=h(" 导出数据 "),k=h(" 查看历史数据预测 "),U={class:"page-main"},C=g("div",{class:"page-main"},[g("div",{id:"auto-analysis01",class:"alarm-panel01 item"})],-1);d(),T.render=function(e,a,t,s,o,i){const n=r("n-date-picker"),l=r("n-select"),d=r("n-button"),h=r("n-grid-item"),v=r("n-grid"),y=r("n-image"),f=r("n-spin");return c(),m("div",_,[b,A,p(v,{"x-gap":24,cols:24},{default:u((()=>[p(h,null,{default:u((()=>[g("div",I,[g("div",M,[p(n,{value:e.datetimerange,"onUpdate:value":[a[0]||(a[0]=a=>e.datetimerange=a),e.onChangeData],type:"datetimerange"},null,8,["value","onUpdate:value"])]),g("div",O,[p(l,{class:"model-input",value:e.deviceType,"onUpdate:value":[a[1]||(a[1]=a=>e.deviceType=a),e.selectDeviceTypeGet],placeholder:"请选择设备类型",options:e.DevicesTypeOptions},null,8,["value","options","onUpdate:value"])]),g("div",$,[p(l,{class:"model-input",value:e.deviceID,"onUpdate:value":a[2]||(a[2]=a=>e.deviceID=a),placeholder:"请选择设备",options:e.DevicesOptions},null,8,["value","options"])]),p(d,{type:"info",onClick:a[3]||(a[3]=a=>e.exportData(1))},{default:u((()=>[j])),_:1})])])),_:1})])),_:1}),p(v,{"x-gap":24,cols:24,style:{"margin-top":"3rem"}},{default:u((()=>[p(h,null,{default:u((()=>[p(f,{show:e.show},{default:u((()=>[p(d,{quaternary:"",type:"primary",onClick:a[4]||(a[4]=a=>e.exportData(2))},{default:u((()=>[k])),_:1}),g("div",U,[p(y,{src:e.auto_image},null,8,["src"])])])),_:1},8,["show"])])),_:1})])),_:1}),p(v,{"x-gap":24,cols:24},{default:u((()=>[p(h,null,{default:u((()=>[C])),_:1})])),_:1})])},T.__scopeId="data-v-09b3e9ea";export{T as default};
